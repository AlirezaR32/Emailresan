# EmailResan — README (Generated by GitHub Copilot Chat Assistant)

پروژه‌ای ساده برای ارسال ایمیل‌های شخصی‌سازی‌شده از روی یک فایل Excel و قالب متنی. این مخزن شامل ماژول‌های اصلی برای خواندن فایل Excel، ساخت پیام شخصی‌شده، ارسال ایمیل و یک رابط گرافیکی ساده تستی است.

در ادامه توضیحات، نحوهٔ راه‌اندازی، نمونهٔ فایل‌ها و نکات مهم آورده شده است.

-----

## ویژگی‌ها
- خواندن اسامی و ایمیل‌ها از فایل Excel (ستون A: نام، ستون B: ایمیل)
- تولید پیام شخصی‌سازی‌شده با جایگزینی `{name}` در قالب متنی
- ارسال ایمیل با استفاده از smtplib (SMTP + STARTTLS)
- رابط کاربری گرافیکی ساده برای انتخاب فایل‌ها و تست ارسال (Tkinter)

## ساختار پروژه
- src/
  - main.py — اجرای ساده و نمونه (می‌تواند همه ایمیل‌ها را ارسال کند)
  - excel_reader.py — خواندن نام و ایمیل از فایل Excel (پیش‌فرض ../data/test.xlsx)
  - personalized_message.py — خواندن قالب متن و جایگزینی `{name}`
  - mail_sender.py — ارسال ایمیل با تنظیمات موجود در config.py
  - gui.py — رابط گرافیکی (انتخاب فایل Excel و فایل متن)
- data/
  - message.txt — قالب پیش‌فرض پیام (حاوی {name})
  - (place your Excel file here, e.g. test.xlsx)
- requirements.txt — کتابخانه‌های مورد نیاز (openpyxl و ...)

## نیازمندی‌ها
- Python 3.8+
- بسته‌ها: openpyxl و بسته‌های استاندارد پایتون برای ایمیل و tkinter
- دستور نصب پیشنهادی:
  - ایجاد محیط مجازی و نصب:
    - Linux/macOS:
      - python -m venv venv
      - source venv/bin/activate
      - pip install -r requirements.txt
    - Windows:
      - python -m venv venv
      - venv\Scripts\activate
      - pip install -r requirements.txt

توجه: فایل requirements.txt موجود دارای چند بستهٔ اضافی است؛ حداقل به openpyxl نیاز دارید. اگر فقط عملکرد ایمیل‌رسان را می‌خواهید، نصب openpyxl کافی است:
- pip install openpyxl

## پیکربندی ایمیل (مهم — محرمانگی)
فایل mail_sender.py متغیرهای زیر را از یک فایل config.py وارد می‌کند:
- EMAIL_ADDRESS
- EMAIL_PASSWORD
- SMTP_SERVER
- SMTP_PORT

نمونهٔ سادهٔ config.py (در پوشهٔ src یا مسیر قابل import):
```python
# src/config.py
EMAIL_ADDRESS = "your-email@example.com"
EMAIL_PASSWORD = "your-email-password-or-app-password"
SMTP_SERVER = "smtp.gmail.com"
SMTP_PORT = 587
```

نکات مهم امنیتی:
- هرگز رمز حساب را در مخزن عمومی قرار ندهید.
- برای حساب‌های Gmail از App Password (رمز اپلیکیشن) استفاده کنید و احراز هویت دو مرحله‌ای را فعال کنید.
- بهتر است از متغیرهای محیطی یا فایل .env برای ذخیرهٔ رمز استفاده کنید.

## فرمت فایل Excel
- قرار دهید یک فایل Excel (.xlsx) در پوشهٔ data با نام test.xlsx یا مسیر دلخواه و سپس مسیر را در excel_reader.py یا در GUI مشخص کنید.
- فرمت پیشنهادی:
  - ردیف اول: هدر (مثلاً "Name" در A1 و "Email" در B1) — کد از ردیف 2 به بعد می‌خواند.
  - ستون A: نام (برای جایگزینی در قالب)
  - ستون B: ایمیل گیرنده

مثال:
| A (Name) | B (Email) |
|----------|-----------|
| name     | email     |
| علی      | ali@example.com |
| سارا     | sara@example.com |

## قالب پیام (message.txt)
فایل data/message.txt نمونه وجود دارد:
```
سلام {name} عزیز

این یک ایمیل تستی برای پروژه ایمیل‌رسان است.

موفق باشید
```
در فایل قالب از {name} برای درج نام هر گیرنده استفاده می‌شود. در personalized_message.py می‌توانید مسیر فایل را به صورت آرگومان وارد کنید یا مسیر پیش‌فرض را تغییر دهید.

نکته: personalized_message.py در مخزن یک مسیر پیش‌فرض مطلق (ویندوز) دارد — توصیه می‌شود آن را به مسیر نسبی (مثلاً "../data/message.txt") تغییر دهید یا هنگام فراخوانی فایل، مسیر را ارسال کنید.

## نحوهٔ اجرا
1. از طریق خط فرمان (نسخه ساده، بدون GUI):
   - به پوشهٔ src بروید:
     - cd src
   - مطمئن شوید config.py را ایجاد کرده‌اید و data/test.xlsx و data/message.txt در مکان مناسب هستند.
   - اجرا:
     - python main.py

2. با رابط گرافیکی (GUI):
   - cd src
   - python gui.py
   - در پنجره GUI فایل Excel و فایل متن را انتخاب کنید و دکمهٔ ارسال را بزنید (در نسخه فعلی، بعد از انتخاب فایل‌ها فقط یک پیام موفقیت تستی نمایش داده می‌شود و منطق کامل ارسال در GUI متصل نشده است).

## نکات اجرایی و رفع اشکال
- خطای SMTP Authentication:
  - مطمئن شوید SMTP_SERVER و SMTP_PORT درست است (مثلاً Gmail: smtp.gmail.com و پورت 587).
  - برای Gmail از App Password استفاده کنید (در صورت فعال بودن 2FA).
- خطای خواندن Excel:
  - بررسی کنید openpyxl نصب باشد و فایل .xlsx در مسیر صحیح باشد.
- مشکلات encoding (متن فارسی):
  - در personalized_message از encoding="utf-8" هنگام باز کردن فایل متنی استفاده شده است — فایل message.txt را با UTF-8 ذخیره کنید.
- اگر می‌خواهید لاگ پیشرفته‌تر یا مدیریت خطا بهتر اضافه کنید، می‌توانید logging را در mail_sender.py فعال کنید و نتایج ارسال را به یک فایل گزارش بنویسید.

## پیشنهادات بهبود (برای توسعه)
- اصلاح personalized_message.py برای استفاده از مسیر نسبی پیش‌فرض یا پارامتر ورودی.
- اتصال GUI به منطق ارسال واقعی و نمایش پروگرس/لاگ به کاربر.
- افزودن قابلیت ارسال ضمیمه‌ها.
- پشتیبانی از قالب‌های HTML و جایگذاری متغیرهای بیشتر.
- استفاده از متغیرهای محیطی یا python-dotenv برای مدیریت امن‌تر credentialها.
- اضافه کردن تست واحد برای هر ماژول.

## نمونهٔ سریع (نمونه config و فایل‌ها)
- src/config.py (نمونه)
```python
EMAIL_ADDRESS = "you@example.com"
EMAIL_PASSWORD = "app-password"
SMTP_SERVER = "smtp.gmail.com"
SMTP_PORT = 587
```
- data/message.txt: (همانکه در بالا آمده)
- data/test.xlsx: شامل ستون‌های Name و Email

## مشارکت و لایسنس
- لایسنس پیشنهادی: MIT (در صورت تمایل اضافه کنید)
- خوشحال می‌شم اگر بفرمایید چه موارد بیشتری می‌خواهید در README اضافه کنم (مثلاً دستورالعمل تغییر کد، افزودن Dockerfile، نمونهٔ فایل Excel واقعی و غیره).
